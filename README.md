# rx-template-structuredLogging
Репозиторий с шаблоном разработки «Библиотека структур и методов для структурированного логирования».

## Описание
Шаблон позволяет:
- Структурированно логировать информацию с указанием ключевой информации:
  - Функция
  - Операция
  - Текст ошибки (при наличии)
  - Произвольная информация в виде Ключ-Значение.
  
По данным сформированным с помощью данного шаблона можно строить метрики в специальных сервисах, таких как Kibana, Grafana, Мониторинг Directum RX. 

Состав объектов разработки:
- модуль Структурированное логирование
- набор серверных методов
- набор констант значений по умолчанию
- набор структур для формирования Json

Поскольку шаблон разработки не содержит перекрытий объектов коробочного решения, конфликты при публикации не возникнут. Это позволяет использовать функциональность, как при старте нового проекта, так и в ходе сопровождения существующих инсталляций системы.

> [!NOTE]
>
> Замечания и пожеланию по развитию шаблона разработки фиксируйте через [Issues](https://github.com/TanaisCompany/rx-template-structuredLogging/issues).
>
> При оформлении ошибки, опишите сценарий для воспроизведения. Для пожеланий приведите обоснование для описываемых изменений - частоту использования, бизнес-ценность, риски и/или эффект от реализации.
>
>
>
> Внимание! Изменения будут вноситься только в новые версии.

## Варианты расширения функциональности на проектах
1. Добавление перегрузок методов под специфические нужды проекта/задачи.
2. Расширение существующих или добавление новых структур.
3. Расширение списка констант.

## Примеры использования некоторых аргументов и функций

1. Аргумент operation в функциях ErrorLogger и DebugLogger предназначен для передачи операций например:
- создание, получение, сохранение сущности
- отправка запроса, выгрузка файла
- начало или завершение АО.

2. Аргумент parameters в функциях ErrorLogger и DebugLogger имеет тип словарь и предназначен для передачи любой опциональной информации, например:
- в интеграции - "MessageGuid": "*значение гуид*", "Result": "*результат обработки*", "Description": "*Описание ошибки*"
- иногда требуются в логах именованные идентификаторы, для этого можно передать "Сотрудник": "*табельный номер*" или "Банк": "*наименование банка*"

Шаблон содержит решение **Tanais.ExampleSln**, в котором реализовано несколько примеров использования структурированного логирования в виде готового кода:
1. АО для обработки сущности из интеграции.
   - *Логируется:* старт и завершение АО, ключевые точки обработки, получение сопутствующих справочников, обработанные исключения.
2. ФП "Рассылка уведомлений".
   - *Логируется:* старт и завершение ФП, ключевые точки выполнения рассылки, получение сопутствующих данных, обработанные исключения.

В комментариях к примерам подробно расписаны смысл и назначение используемых параметров для демонстрации логики использования методов.

***Перед использованием шаблона необходимо удалить решение Tanais.ExampleSln.***

## Порядок установки
Для работы требуется установленный Directum RX версии 4.9 и выше.

### Установка для ознакомления
1. Склонировать репозиторий rx-template-structuredLogging в папку.
2. Указать в _ConfigSettings.xml DDS:
   ```xml
   <block name="REPOSITORIES">
     <repository folderName="Base" solutionType="Base" url="" />
     <repository folderName="RX" solutionType="Base" url="<адрес локального репозитория>" />
     <repository folderName="<Папка из п.1>" solutionType="Work" 
       url="https://github.com/TanaisCompany/rx-template-structuredLogging.git" />
   </block>
   ```

### Установка для использования на проекте
Возможные варианты:

**A. Fork репозитория**

1. Сделать fork репозитория rx-template-structuredLogging для своей учетной записи.
2. Склонировать созданный в п. 1 репозиторий в папку.
3. Указать в _ConfigSettings.xml DDS:
   ``` xml
   <block name="REPOSITORIES">
     <repository folderName="Base" solutionType="Base" url="" />
     <repository folderName="<Папка из п.2>" solutionType="Work"
       url="<Адрес репозитория gitHub учетной записи пользователя из п. 1>" />
   </block>
   ```

**B. Подключение на базовый слой.**

Вариант не рекомендуется, так как при выходе версии шаблона разработки не гарантируется обратная совместимость.
1. Склонировать репозиторий rx-template-structuredLogging в папку.
2. Указать в _ConfigSettings.xml DDS:
   ``` xml
   <block name="REPOSITORIES">
     <repository folderName="Base" solutionType="Base" url="" />
     <repository folderName="<Папка из п.1>" solutionType="Base"
       url="https://github.com/TanaisCompany/rx-template-structuredLogging.git" />
     <repository folderName="<Папка для рабочего слоя>" solutionType="Work"
       url="<Адрес репозитория gitHub>" />
   </block>
   ```

**C. Копирование репозитория в систему контроля версий.**

Рекомендуемый вариант для проектов внедрения.
1. В системе контроля версий с поддержкой git создать новый репозиторий.
2. Склонировать репозиторий rx-template-structuredLogging в папку с ключом `--mirror`.
3. Перейти в папку из п. 2.
4. Импортировать клонированный репозиторий в систему контроля версий командой: \
   `git push –mirror <Адрес репозитория из п. 1>`
